!function(){var t,e={},a={top:10,bottom:25,left:50,right:10},r=0,n=0,l=d3.select(".chart__gender"),i=l.select("svg");function o(){var t=l.node().offsetWidth,o=Math.floor(t/ratio);r=t-a.left-a.right,n=o-a.top-a.bottom,i.attr("width",t).attr("height",o);var s,c,d="translate("+a.left+","+a.top+")",x=i.select(".container");x.attr("transform",d),s=r,c=n,e.count.x.range([0,s]),e.percent.x.range([0,s]),e.count.y.range([c,0]),e.percent.y.range([c,0]);var f=d3.area().x(function(t){return e[state].x(t.data.date)}).y0(function(t){return e[state].y(t[0])}).y1(function(t){return e[state].y(t[1])}).curve(d3.curveMonotoneX),u=l.select(".area-container").selectAll(".area").data(stackedData);u.exit().remove();var p=u.enter().append("path").attr("class","area");!function(t){var a=mobile?5:10,l=d3.axisBottom(e[state].x).ticks(a);t.select(".axis--x").attr("transform","translate(0,"+n+")").call(l);var i="percent"===state?"%":"r",o=d3.axisLeft(e[state].y).ticks(a,i).tickSizeInner(-r);t.select(".axis--y").transition().duration(transitionDuration).call(o)}(x),function(t){i.select(".label--y").text(labels[state]).transition().duration(transitionDuration).attr("transform","translate("+a.left/4+","+n/2+")rotate(-90)");var e=setLabelY("male",r,n),l=setLabelY("female",r,n);t.select(".area__label--women").transition().duration(transitionDuration).attr("x",.95*r).attr("y",l).style("text-anchor","end"),t.select(".area__label--men").transition().duration(transitionDuration).attr("x",.95*r).attr("y",e).style("text-anchor","end")}(x),vertical=x.select(".vertical").attr("height",n).attr("y",0),u.merge(p).transition().duration(transitionDuration).attr("d",f).style("fill",function(t){var a=t.key.split("_")[0];return e.color(a)})}function s(){var t=d3.select("body").node().offsetWidth;mobile=t<600,o()}t=function(){var t;(t=i.select(".container")).append("g").attr("class","axis axis--x"),t.append("g").attr("class","axis axis--y"),t.append("g").attr("class","area-container"),t.append("rect").attr("class","vertical").attr("width",1).attr("x",0),i.append("text").attr("class","label--y").attr("text-anchor","middle"),i.append("text").attr("class","label--x").attr("text-anchor","middle"),t.append("text").attr("class","area__label area__label--men").style("text-anchor","end").style("fill",d3.color(colorM).darker(1.5)).text("Men"),t.append("text").attr("class","area__label area__label--women").style("text-anchor","end").style("fill",d3.color(colorF).brighter(2)).text("Women"),t.append("line").attr("class","fifty-percent fifty-percent-line"),t.append("text").attr("class","fifty-percent fifty-percent-label").attr("alignment-baseline","baseline").attr("text-anchor","middle").text("Gender Equality (50%)"),t.append("rect").attr("x",0).attr("y",0).attr("class","interaction"),function(){var t=d3.max(genderData,function(t){return t.total}),a=d3.scaleTime().domain(d3.extent(genderData,function(t){return t.date})),r=d3.scaleLinear().domain([0,t]);e.count={x:a,y:r};var n=d3.scaleTime().domain(d3.extent(genderData,function(t){return t.date})),l=d3.scaleLinear();e.percent={x:n,y:l},e.color=d3.scaleOrdinal().domain(["male_count","female_count"]).range(colors)}(),s(),window.addEventListener("resize",s)},d3.tsv("assets/gender_count.tsv",cleaRow,function(e,a){genderData=a,t()})}();