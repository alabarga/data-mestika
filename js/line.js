var margin={top:48,right:48,bottom:48,left:48},width=1e3-margin.left-margin.right,height=650-margin.top-margin.bottom;function jobYear(){var t,a,e,r,n,i=d3.select(".dm-job-year-graph"),d=i.append("g").classed("axisLayer",!0),o=i.append("g").classed("chartLayer",!0),s=d3.scaleTime(),c=d3.scaleLinear(),l=d3.timeParse("%d-%b-%y");function f(l){var f;f=l,t=document.querySelector(".dm-container-graph").clientWidth,a=document.querySelector(".dm-container-graph").clientHeight,e=t-((n={top:48,left:48,bottom:48,right:48}).left+n.right),r=a-(n.top+n.bottom),i.attr("width",t).attr("height",a),d.attr("width",t).attr("height",a),o.attr("width",e).attr("height",r).attr("transform","translate("+[n.left,n.top]+")"),s.domain(d3.extent(f,function(t){return t.fecha})).range([0,e]),c.domain([0,d3.max(f,function(t){return t.total})]).range([r,0]),function(){var t=d3.axisLeft(c).tickSizeInner(-e).tickFormat(d3.format("d")).ticks(10),a=d.selectAll(".y").data(["dummy"]),i=a.enter().append("g").attr("class","axis y");a.merge(i).attr("transform","translate("+[n.left,n.top]+")").call(t);var o=d3.axisBottom(s),l=d.selectAll(".x").data(["dummy"]),f=l.enter().append("g").attr("class","axis x");l.merge(f).attr("transform","translate("+[n.left,r+n.top]+")").call(o)}(),function(t){var a=d3.line().x(function(t){return s(t.fecha)}).y(function(t){return c(t.total)}),e=o.selectAll(".line").data([t]),r=e.enter().append("path").attr("class","line").attr("stroke-width","1.5");e.merge(r).attr("d",a);var n=r.node().getTotalLength();r.attr("stroke-dasharray",n+" "+n).attr("stroke-dashoffset",n).transition().duration(2500).ease(d3.easeLinear).attr("stroke-dashoffset",0),o.selectAll("circles").data(t).enter().append("circle").attr("cx",function(t){return s(t.fecha)}).attr("cy",function(t){return c(t.total)}).attr("class","circles").attr("r",3)}(l)}d3.csv("csv/data-ofertas-anyo.csv",function(t){return t.fecha=l(t.fecha),t.total=+t.total,t},function(t){f(t),a=t,window.addEventListener("resize",function(t){!1!==e&&clearTimeout(e),e=setTimeout(function(){f(a)})});var a,e})}function centralizame(){var t=50,a=50,e=200,r=d3.select(".dm-job-city-graph").attr("class","dm-job-city-chart").append("g").attr("transform","translate("+(e-a)+","+t+")"),n=d3.scaleLinear().range([0,width]),i=d3.scaleBand().range([height,0]),d=d3.format(".0%"),o=d3.axisBottom(n).tickSize(-height).tickFormat(function(t){return d(t/100)}).ticks(10),s=d3.axisLeft(i);d3.csv("csv/data-ciudades-porcentaje.csv",function(t,a){a.forEach(function(t){t.ciudad=t.ciudad,t.cantidad=+t.cantidad}),a.sort(function(t,a){return t.cantidad-a.cantidad}),n.domain([0,d3.max(a,function(t){return t.cantidad})]),i.domain(a.map(function(t){return t.ciudad})).paddingInner(.2).paddingOuter(.5),r.append("g").attr("class","xAxis").attr("transform","translate(0,"+height+")").call(o).append("text").attr("class","label").attr("transform","translate("+width+",0)").attr("y",-5).style("text-anchor","end").text("Frequency"),r.append("g").attr("class","yAxis").call(s),r.selectAll(".bar").data(a).enter().append("rect").attr("class","bar").attr("x",0).attr("height",i.bandwidth()).attr("y",function(t){return i(t.ciudad)}).transition().duration(1500).ease(d3.easePolyInOut).attr("width",function(t){return n(t.cantidad)})})}function remote(){var t=d3.select(".dm-job-remote-graph").attr("class","dm-job-remote-chart").append("g").attr("transform","translate("+margin.left+","+margin.top+")"),a=d3.timeParse("%d-%b-%y"),e=d3.scaleTime().range([0,width]),r=d3.scaleLinear().range([height,0]),n=d3.line().x(function(t){return e(t.fecha)}).y(function(t){return r(t.total)}),i=d3.axisLeft(r).tickSize(-width).tickFormat(d3.format("d")).ticks(10);d3.csv("csv/data-remoto-mes.csv",function(d,o){if(d)throw d;o.forEach(function(t){t.fecha=a(t.fecha),t.total=+t.total}),e.domain(d3.extent(o,function(t){return t.fecha})),r.domain([0,d3.max(o,function(t){return t.total})]);var s=t.append("path").data([o]).attr("class","lines").attr("d",n).attr("stroke-width","1.5").attr("fill","none"),c=s.node().getTotalLength();s.attr("stroke-dasharray",c+" "+c).attr("stroke-dashoffset",c).transition().duration(2500).ease(d3.easeLinear).attr("stroke-dashoffset",0),t.append("g").attr("class","xAxis").attr("transform","translate(0,"+height+")").call(d3.axisBottom(e)),t.append("g").attr("class","yAxis").call(i),t.selectAll("dot").data(o).enter().append("circle").attr("cx",function(t){return e(t.fecha)}).attr("cy",function(t){return r(t.total)}).attr("class","circles").attr("r",3)})}function multiple(){var t=d3.select(".dm-job-multiple-graph").attr("class","dm-job-multiple-chart").append("g").attr("transform","translate("+margin.left+","+margin.top+")"),a=d3.timeParse("%Y"),e=d3.scaleTime().range([0,width]),r=d3.scaleLinear().range([height,0]),n=d3.line().x(function(t){return e(t.fecha)}).y(function(t){return r(t.cantidad)}),i=d3.axisLeft(r).tickSize(-width).tickFormat(d3.format("d")).ticks(10);d3.csv("csv/data-line-puestos.csv",function(d,o){o.forEach(function(t){t.fecha=a(t.fecha),t.cantidad=+t.cantidad}),e.domain(d3.extent(o,function(t){return t.fecha})),r.domain([0,d3.max(o,function(t){return t.cantidad})]);var s=d3.nest().key(function(t){return t.puesto}).entries(o),c=d3.scaleOrdinal(["#b114c0","#9C1B12","#759CA7","#CEBAC6","#2D3065"]);s.forEach(function(a){t.append("path").attr("class","line").style("stroke",function(){return a.color=c(a.key)}).attr("d",n(a.values))}),t.append("g").attr("class","xAxis").attr("transform","translate(0,"+height+")").call(d3.axisBottom(e)),t.append("g").attr("class","yAxis").call(i),d3.selectAll(".line").each(function(t,a){var e=d3.select(".line").node().getTotalLength();d3.selectAll(".line").attr("stroke-dasharray",e+" "+e).attr("stroke-dashoffset",e).transition().duration(4e3).delay(200*a).ease(d3.easeExpIn).attr("stroke-dashoffset",0).style("stroke-width",2)})})}function flashJob(){var t,a,e,r,n,i=d3.select(".dm-job-flash-graph"),d=i.append("g").classed("axisLayer",!0),o=i.append("g").classed("chartLayer",!0),s=d3.scaleTime(),c=d3.scaleLinear(),l=d3.timeParse("%d-%b-%y");function f(l){var f,u,m,h,g;f=l,t=document.querySelector(".dm-container-graph").clientWidth,a=document.querySelector(".dm-container-graph").clientHeight,e=t-((n={top:48,left:48,bottom:48,right:48}).left+n.right),r=a-(n.top+n.bottom),i.attr("width",t).attr("height",a),d.attr("width",t).attr("height",a),o.attr("width",e).attr("height",r).attr("transform","translate("+[n.left,n.top]+")"),s.domain(d3.extent(f,function(t){return t.fecha})).range([0,e]),c.domain([0,d3.max(f,function(t){return t.total})]).range([r,0]),function(){var t=d3.axisLeft(c).tickSizeInner(-e).tickFormat(d3.format("d")).ticks(10),a=d.selectAll(".y").data(["dummy"]),i=a.enter().append("g").attr("class","axis y");a.merge(i).attr("transform","translate("+[n.left,n.top]+")").call(t);var o=d3.axisBottom(s),l=d.selectAll(".x").data(["dummy"]),f=l.enter().append("g").attr("class","axis x");l.merge(f).attr("transform","translate("+[n.left,r+n.top]+")").call(o)}(),u=l,m=d3.line().x(function(t){return s(t.fecha)}).y(function(t){return c(t.total)}),h=o.selectAll(".line").data([u]),g=h.enter().append("path").attr("class","line").attr("stroke-width","1.5"),h.merge(g).attr("d",m)}d3.csv("csv/data-flash-mes.csv",function(t){return t.fecha=l(t.fecha),t.total=+t.total,t},function(t){f(t),a=t,window.addEventListener("resize",function(t){!1!==e&&clearTimeout(e),e=setTimeout(function(){f(a)})});var a,e})}function animateDendogram(){var t=function(t,a){return 200*a};anime.timeline().add({targets:".mdl-two",strokeDashoffset:[anime.setDashoffset,0],easing:"easeInOutSine",delay:t,duration:600}).add({targets:".madrid-dendogram-circle-middle",r:[0,5],easing:"easeInOutSine",delay:t,duration:300}).add({targets:".madrid-dendogram-text-job",opacity:[0,1],easing:"easeInOutSine",delay:t,duration:300}).add({targets:".mdl-three",strokeDashoffset:[anime.setDashoffset,0],easing:"easeInOutSine",delay:t,duration:600}).add({targets:".madrid-dendogram-circle-final",r:function(t){return 1.25*t.getAttribute("mydata:id")},easing:"easeInOutSine",delay:t,duration:600}).add({targets:".madrid-dendogram-text-percentage",opacity:[0,1],easing:"easeInOutSine",delay:t,duration:300})}jobYear(),centralizame(),remote(),multiple(),flashJob(),animateDendogram();